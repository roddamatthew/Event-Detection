import pytest
from scapy.all import Raw

from scapy_artemissbs.layers import FighterBayStatus


class TestInit:
    @pytest.mark.parametrize(
        "bytes_, length",
        [
            (
                b"\xbd\x07\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00B\x00L\x00B\x00-\x000\x00\x00\x00\x0c\x00\x00\x00T\x00S\x00N\x00 \x00S\x00h\x00u\x00t\x00t\x00l\x00e\x00\x00\x00\x00\x00\x00\x00\xbe\x07\x00\x00\x01\x00\x00\x00\x06\x00\x00\x00H\x00A\x00H\x00-\x001\x00\x00\x00\x13\x00\x00\x00T\x00S\x00N\x00 \x00M\x00e\x00d\x00i\x00u\x00m\x00 \x00F\x00i\x00g\x00h\x00t\x00e\x00r\x00\x00\x00\x00\x00\x00\x00\xbf\x07\x00\x00\x02\x00\x00\x00\x06\x00\x00\x00R\x00F\x00R\x00-\x002\x00\x00\x00\x13\x00\x00\x00T\x00S\x00N\x00 \x00M\x00e\x00d\x00i\x00u\x00m\x00 \x00F\x00i\x00g\x00h\x00t\x00e\x00r\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",
                3,
            ),
        ],
    )
    def test_bytes(self, bytes_, length):
        packet = FighterBayStatus(bytes_)
        assert len(packet.bays) == length
        assert Raw not in packet
